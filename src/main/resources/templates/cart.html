
<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{base::layout(~{::section})}">

	<section>

		<div class="untree_co-section before-footer-section">
            <div class="container">
				<div class="row mb-5">
					<form class="col-md-12" method="post">
						<div class="site-blocks-table">
							<table class="table" th:if="${cartItems != null and !#lists.isEmpty(cartItems)}">
								<thead>
									<tr>
										<th class="product-thumbnail">Image</th>
										<th class="product-name">Product</th>
										<th class="product-price">Price</th>
										<th class="product-quantity">Quantity</th>
										<th class="product-total">Total</th>
										<th class="product-remove">Remove</th>
									</tr>
								</thead>
								<tbody >
									<tr th:each="cartItem : ${cartItems}">
										<td class="product-thumbnail">
											<img th:src="@{'/img/product_img/'+${cartItem.product.image}}" alt="Image" class="img-fluid">
										</td>
										<td class="product-name">
											<h2 class="h5 text-black">[[${cartItem.product.title}]]</h2>
										</td>
										<td>$[[${cartItem.product.price}]]</td>
										<td>
											<div class="input-group mb-3 d-flex align-items-center quantity-container" style="max-width: 120px;margin: auto">
												<div class="input-group-prepend">
													<button class="btn btn-outline-black decrease updateCart" type="button" th:data-action="delete" th:data-id="${cartItem.product.id}">&minus;</button>
												</div>
												<input type="text" class="form-control text-center quantity-amount" th:value="${cartItem.quantity}" aria-describedby="button-addon1" readonly>
												<div class="input-group-append">
													<button class="btn btn-outline-black increase updateCart" type="button" th:data-action="update" th:data-id="${cartItem.product.id}">&plus;</button>
												</div>
											</div>
										</td>
										<td>$[[${cartItem.product.price*cartItem.quantity}]]</td>
										<td><a href="#" class="btn btn-black btn-sm updateCart" th:data-action="remove" th:data-id="${cartItem.product.id}">X</a></td>
									</tr>
								</tbody>
							</table>
						</div>
					</form>

					<div class="alert alert-dark" role="alert" th:unless="${cartItems != null and !#lists.isEmpty(cartItems)}">You don't have any cart!</div>
				</div>

				<div class="row">
					<div class="col-md-6">
						<div class="row mb-5">
<!--							<div class="col-md-6 mb-3 mb-md-0">-->
<!--								<button class="btn btn-black btn-sm btn-block">Update Cart</button>-->
<!--							</div>-->
							<div class="col-md-6">
								<a class="btn btn-outline-black btn-sm btn-block" th:href="@{/product}">Continue Shopping</a>
							</div>
						</div>
						<div class="row">
							<div class="col-md-12">
								<label class="text-black h4" for="coupon">Coupon</label>
								<p>Enter your coupon code if you have one.</p>
							</div>
							<div class="col-md-8 mb-3 mb-md-0">
								<input type="text" class="form-control py-3" id="coupon" placeholder="Coupon Code">
							</div>
							<div class="col-md-4">
								<button class="btn btn-black">Apply Coupon</button>
							</div>
						</div>
					</div>
					<div class="col-md-6 pl-5">
						<div class="row justify-content-end">
							<div class="col-md-7">
								<div class="row">
									<div class="col-md-12 text-right border-bottom mb-5">
										<h3 class="text-black h4 text-uppercase">Cart Totals</h3>
									</div>
								</div>
								<div class="row mb-3">
<!--									<div class="col-md-6">-->
<!--										<span class="text-black">Subtotal</span>-->
<!--									</div>-->
<!--									<div class="col-md-6 text-right">-->
<!--										<strong class="text-black">$230.00</strong>-->
<!--									</div>-->
								</div>
								<div class="row mb-5">
									<div class="col-md-6">
										<span class="text-black">Total</span>
									</div>
									<div class="col-md-6 text-right">
										<strong class="text-black">$[[${totalPrice}]]</strong>
									</div>
								</div>

								<div class="row">
									<div class="col-md-12"><a class="btn btn-black btn-lg py-3 btn-block" href="checkout" th:href="@{/checkout}">Proceed To Checkout</a></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>



	</section>
		<script src="/js/bootstrap.bundle.min.js"></script>
		<script src="/js/tiny-slider.js"></script>
		<script src="/js/custom2.js"></script>
		<script>
			// let updateCart = document.getElementsByClassName("updateCart")
			// for (let i=0;i<updateCart.length;i++){
			// 	updateCart[i].addEventListener("click",function(){
			// 		let itemId = this.dataset.id
			// 		let action = this.dataset.action
			// 		updateItemCart(itemId,action)
			// 	})
			// }
			// function updateItemCart(itemId, action) {
			// 	fetch('/update-cart', {
			// 		method: 'POST',
			// 		headers: {
			// 			'Content-Type': 'application/json'
			// 		},
			// 		body: JSON.stringify({ id: itemId, action: action })
			// 	})
			// 			.then(response => response.json())
			// 			.then(data => {
			// 				// Xử lý phản hồi từ server, cập nhật UI nếu cần
			// 				console.log(data);
			// 			})
			// 			.catch(error => {
			// 				console.error('Error:', error);
			// 			});
			// }
		</script>

</html>
